<!doctype html>
<html lang="fr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chatbot Futuriste</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }

    * {
      box-sizing: border-box;
    }

    html {
      height: 100%;
      width: 100%;
    }

    .chat-wrapper {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7fa8d8 100%);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    .chat-wrapper::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
      pointer-events: none;
    }

    .chat-header {
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      z-index: 10;
    }

    .chat-header h1 {
      margin: 0;
      color: white;
      font-size: 28px;
      font-weight: 600;
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      z-index: 1;
    }

    .chat-messages::-webkit-scrollbar {
      width: 8px;
    }

    .chat-messages::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    .chat-messages::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }

    .chat-messages::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.4);
    }

    .message {
      display: flex;
      align-items: flex-end;
      gap: 10px;
      animation: slideIn 0.3s ease-out;
      max-width: 80%;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message.user {
      align-self: flex-end;
      flex-direction: row-reverse;
    }

    .message.bot {
      align-self: flex-start;
    }

    .message-bubble {
      padding: 12px 18px;
      border-radius: 18px;
      position: relative;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      word-wrap: break-word;
      line-height: 1.5;
    }

    .message.bot .message-bubble {
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      color: white;
      border-bottom-left-radius: 4px;
    }

    .message.user .message-bubble {
      background: white;
      color: #1e293b;
      border-bottom-right-radius: 4px;
    }

    .message-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
    }

    .message.bot .message-avatar {
      background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
      box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
    }

    .message.user .message-avatar {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
    }

    .chat-input-container {
      padding: 20px;
      background: rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      border-top: 2px solid rgba(255, 255, 255, 0.2);
      z-index: 10;
    }

    .chat-input-form {
      display: flex;
      gap: 12px;
      max-width: 1000px;
      margin: 0 auto;
    }

    .chat-input {
      flex: 1;
      padding: 14px 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.95);
      color: #1e293b;
      font-size: 16px;
      outline: none;
      transition: all 0.3s ease;
    }

    .chat-input:focus {
      border-color: rgba(255, 255, 255, 0.6);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    }

    .chat-input::placeholder {
      color: #94a3b8;
    }

    .send-button {
      padding: 14px 28px;
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      color: white;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }

    .send-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
    }

    .send-button:active {
      transform: translateY(0);
    }

    .send-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .typing-indicator {
      display: none;
      align-items: center;
      gap: 10px;
      padding: 12px 18px;
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      border-radius: 18px;
      border-bottom-left-radius: 4px;
      max-width: 80px;
    }

    .typing-indicator.active {
      display: flex;
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      background: white;
      border-radius: 50%;
      animation: typing 1.4s infinite;
    }

    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes typing {
      0%, 60%, 100% {
        opacity: 0.3;
        transform: scale(0.8);
      }
      30% {
        opacity: 1;
        transform: scale(1);
      }
    }

    .empty-state {
      text-align: center;
      color: white;
      padding: 40px 20px;
      opacity: 0.8;
    }

    .empty-state h2 {
      font-size: 24px;
      margin-bottom: 12px;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }

    .empty-state p {
      font-size: 16px;
      opacity: 0.9;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="chat-wrapper">
   <header class="chat-header">
    <h1 id="bot-name">Assistant IA</h1>
   </header>
   <main class="chat-messages" id="chat-messages">
    <div class="empty-state" id="empty-state">
     <h2>‚ú® Bienvenue !</h2>
     <p id="welcome-message">Bonjour ! Comment puis-je vous aider aujourd'hui ?</p>
    </div>
   </main>
   <div class="typing-indicator" id="typing-indicator">
    <div class="typing-dot"></div>
    <div class="typing-dot"></div>
    <div class="typing-dot"></div>
   </div>
   <div class="chat-input-container">
    <form class="chat-input-form" id="chat-form"><label for="user-input" style="position: absolute; left: -10000px;">Votre message</label> <input type="text" id="user-input" class="chat-input" placeholder="Posez votre question..." autocomplete="off" required> <button type="submit" class="send-button" id="send-button">Envoyer</button>
    </form>
   </div>
  </div>
  <script>
    const defaultConfig = {
      bot_name: "Assistant IA",
      welcome_message: "Bonjour ! Comment puis-je vous aider aujourd'hui ?",
      primary_color: "#2563eb",
      background_start: "#1e3c72",
      background_middle: "#2a5298",
      background_end: "#7fa8d8",
      user_message_color: "#ffffff",
      font_family: "Segoe UI",
      font_size: 16
    };

    let messages = [];
    let isTyping = false;

    const chatMessages = document.getElementById('chat-messages');
    const chatForm = document.getElementById('chat-form');
    const userInput = document.getElementById('user-input');
    const sendButton = document.getElementById('send-button');
    const typingIndicator = document.getElementById('typing-indicator');
    const emptyState = document.getElementById('empty-state');

    function getBotResponse(userMessage) {
      const msg = userMessage.toLowerCase().trim();
      
      // Salutations
      if (msg.includes('bonjour') || msg.includes('salut') || msg.includes('hello') || msg.includes('hey') || msg === 'hi') {
        return "Bonjour ! Je suis votre assistant virtuel. Posez-moi vos questions et je vous donnerai des r√©ponses claires et pr√©cises.";
      }
      
      // Aide
      if (msg.includes('aide') || msg.includes('help') || msg.includes('que peux-tu faire')) {
        return "Je peux r√©pondre √† vos questions sur de nombreux sujets : sciences, histoire, g√©ographie, math√©matiques, technologie, culture g√©n√©rale, et bien plus. Posez-moi une question sp√©cifique !";
      }
      
      // Remerciements
      if (msg.includes('merci') || msg.includes('thanks')) {
        return "De rien ! Je suis l√† pour vous aider. N'h√©sitez pas √† me poser d'autres questions.";
      }

      // Comment √ßa va
      if ((msg.includes('comment') && msg.includes('vas')) || (msg.includes('√ßa') && msg.includes('va'))) {
        return "Je fonctionne parfaitement ! Je suis pr√™t √† r√©pondre √† toutes vos questions. Que souhaitez-vous savoir ?";
      }

      // Identit√©
      if (msg.includes('qui es-tu') || msg.includes('qui es tu') || msg.includes('ton nom') || msg.includes('c\'est quoi ton nom')) {
        return `Je suis ${window.elementSdk.config.bot_name || defaultConfig.bot_name}, un assistant conversationnel intelligent. Je suis con√ßu pour r√©pondre √† vos questions de mani√®re claire et pr√©cise.`;
      }

      // ===== CAPITALES DU MONDE =====
      if (msg.includes('capitale') && msg.includes('france')) {
        return "La capitale de la France est Paris. Situ√©e sur la Seine, elle compte 2,2 millions d'habitants (12 millions dans l'agglom√©ration). Paris est surnomm√©e la 'Ville Lumi√®re'.";
      }
      if (msg.includes('capitale') && msg.includes('canada')) {
        return "La capitale du Canada est Ottawa, situ√©e en Ontario. Elle compte environ 1 million d'habitants et est bilingue (anglais-fran√ßais).";
      }
      if (msg.includes('capitale') && msg.includes('italie')) {
        return "La capitale de l'Italie est Rome. Fond√©e en 753 av. J.-C., elle abrite le Vatican et compte 2,8 millions d'habitants.";
      }
      if (msg.includes('capitale') && (msg.includes('allemagne') || msg.includes('german'))) {
        return "La capitale de l'Allemagne est Berlin. R√©unifi√©e en 1990, elle compte 3,7 millions d'habitants et est la plus grande ville du pays.";
      }
      if (msg.includes('capitale') && (msg.includes('espagne') || msg.includes('spain'))) {
        return "La capitale de l'Espagne est Madrid. Situ√©e au centre du pays √† 667m d'altitude, elle compte 3,3 millions d'habitants.";
      }
      if (msg.includes('capitale') && (msg.includes('royaume-uni') || msg.includes('angleterre') || msg.includes('uk'))) {
        return "La capitale du Royaume-Uni est Londres. Fond√©e par les Romains, elle compte 9 millions d'habitants et est un centre financier mondial.";
      }
      if (msg.includes('capitale') && (msg.includes('japon') || msg.includes('japan'))) {
        return "La capitale du Japon est Tokyo. Avec 14 millions d'habitants (37 millions dans l'agglom√©ration), c'est la plus grande m√©tropole du monde.";
      }
      if (msg.includes('capitale') && (msg.includes('chine') || msg.includes('china'))) {
        return "La capitale de la Chine est P√©kin (Beijing). Elle compte 21 millions d'habitants et abrite la Cit√© Interdite.";
      }
      if (msg.includes('capitale') && (msg.includes('√©tats-unis') || msg.includes('usa') || msg.includes('etats-unis'))) {
        return "La capitale des √âtats-Unis est Washington D.C. (District of Columbia). Elle compte 700 000 habitants et abrite la Maison Blanche et le Capitole.";
      }
      if (msg.includes('capitale') && (msg.includes('br√©sil') || msg.includes('brazil') || msg.includes('bresil'))) {
        return "La capitale du Br√©sil est Bras√≠lia. Inaugur√©e en 1960, elle a √©t√© con√ßue par l'architecte Oscar Niemeyer et compte 3 millions d'habitants.";
      }
      if (msg.includes('capitale') && (msg.includes('russie') || msg.includes('russia'))) {
        return "La capitale de la Russie est Moscou. C'est la plus grande ville d'Europe avec 12,6 millions d'habitants. Elle abrite le Kremlin et la Place Rouge.";
      }
      if (msg.includes('capitale') && (msg.includes('inde') || msg.includes('india'))) {
        return "La capitale de l'Inde est New Delhi. Elle fait partie de la r√©gion de Delhi qui compte 32 millions d'habitants, ce qui en fait la deuxi√®me agglom√©ration la plus peupl√©e du monde.";
      }
      if (msg.includes('capitale') && (msg.includes('australie') || msg.includes('australia'))) {
        return "La capitale de l'Australie est Canberra (et non Sydney). Elle compte 430 000 habitants et a √©t√© sp√©cialement construite pour √™tre la capitale en 1913.";
      }
      if (msg.includes('capitale') && msg.includes('egypte')) {
        return "La capitale de l'√âgypte est Le Caire. Avec 20 millions d'habitants, c'est la plus grande ville d'Afrique et du monde arabe. Elle se trouve pr√®s des pyramides de Gizeh.";
      }
      if (msg.includes('capitale') && (msg.includes('maroc') || msg.includes('morocco'))) {
        return "La capitale du Maroc est Rabat. Elle compte 580 000 habitants. Casablanca est la plus grande ville mais n'est pas la capitale.";
      }
      if (msg.includes('capitale') && (msg.includes('suisse') || msg.includes('switzerland'))) {
        return "La capitale de la Suisse est Berne. Elle compte 144 000 habitants et est le si√®ge du gouvernement f√©d√©ral suisse depuis 1848.";
      }

      // ===== G√âOGRAPHIE =====
      if (msg.includes('combien') && msg.includes('continent')) {
        return "Il y a 7 continents sur Terre : l'Afrique, l'Am√©rique du Nord, l'Am√©rique du Sud, l'Antarctique, l'Asie, l'Europe et l'Oc√©anie.";
      }
      if ((msg.includes('plus grand') || msg.includes('plus gros')) && msg.includes('continent')) {
        return "L'Asie est le plus grand continent avec 44,6 millions de km¬≤. Elle repr√©sente 30% des terres √©merg√©es et abrite 60% de la population mondiale.";
      }
      if ((msg.includes('plus grand') || msg.includes('plus gros')) && msg.includes('oc√©an')) {
        return "Le plus grand oc√©an du monde est l'oc√©an Pacifique. Il couvre 165 millions de km¬≤, soit 46% de la surface des oc√©ans et un tiers de la surface terrestre.";
      }
      if ((msg.includes('plus long') || msg.includes('plus grande')) && msg.includes('fleuve')) {
        return "Le plus long fleuve du monde est le Nil en Afrique avec 6 650 km. Il traverse 11 pays avant de se jeter dans la M√©diterran√©e. L'Amazone est le deuxi√®me avec 6 400 km.";
      }
      if ((msg.includes('plus haute') || msg.includes('plus grand')) && msg.includes('montagne')) {
        return "La plus haute montagne du monde est le Mont Everest dans l'Himalaya. Son sommet culmine √† 8 848,86 m√®tres d'altitude √† la fronti√®re entre le N√©pal et le Tibet.";
      }
      if ((msg.includes('plus profond') || msg.includes('plus profonde')) && msg.includes('oc√©an')) {
        return "Le point le plus profond des oc√©ans est la fosse des Mariannes dans l'oc√©an Pacifique. Le Challenger Deep atteint 10 994 m√®tres de profondeur.";
      }
      if (msg.includes('plus grand') && msg.includes('d√©sert')) {
        return "Le plus grand d√©sert du monde est l'Antarctique (14 millions de km¬≤). Le plus grand d√©sert chaud est le Sahara en Afrique (9 millions de km¬≤).";
      }
      if (msg.includes('plus grand') && msg.includes('pays')) {
        return "Le plus grand pays du monde est la Russie avec 17,1 millions de km¬≤. Elle s'√©tend sur 11 fuseaux horaires et couvre 11% des terres √©merg√©es.";
      }
      if (msg.includes('plus petit') && msg.includes('pays')) {
        return "Le plus petit pays du monde est le Vatican avec seulement 0,44 km¬≤. C'est une enclave √† Rome, si√®ge de l'√âglise catholique.";
      }
      if (msg.includes('population') && msg.includes('mondiale')) {
        return "La population mondiale est d'environ 8 milliards d'habitants en 2024. L'Inde est le pays le plus peupl√© (1,43 milliard), suivie de la Chine (1,42 milliard).";
      }

      // ===== MATH√âMATIQUES =====
      if (msg.match(/combien font \d+ \+ \d+/) || msg.match(/\d+ \+ \d+/)) {
        const numbers = msg.match(/\d+/g);
        if (numbers && numbers.length >= 2) {
          const sum = parseInt(numbers[0]) + parseInt(numbers[1]);
          return `${numbers[0]} + ${numbers[1]} = ${sum}`;
        }
      }
      if (msg.match(/combien font \d+ - \d+/) || msg.match(/\d+ - \d+/)) {
        const numbers = msg.match(/\d+/g);
        if (numbers && numbers.length >= 2) {
          const diff = parseInt(numbers[0]) - parseInt(numbers[1]);
          return `${numbers[0]} - ${numbers[1]} = ${diff}`;
        }
      }
      if (msg.match(/combien font \d+ x \d+/) || msg.match(/\d+ x \d+/) || msg.match(/\d+ \* \d+/)) {
        const numbers = msg.match(/\d+/g);
        if (numbers && numbers.length >= 2) {
          const product = parseInt(numbers[0]) * parseInt(numbers[1]);
          return `${numbers[0]} √ó ${numbers[1]} = ${product}`;
        }
      }
      if (msg.match(/combien font \d+ \/ \d+/) || msg.match(/\d+ divis√© par \d+/)) {
        const numbers = msg.match(/\d+/g);
        if (numbers && numbers.length >= 2) {
          const quotient = parseInt(numbers[0]) / parseInt(numbers[1]);
          return `${numbers[0]} √∑ ${numbers[1]} = ${quotient}`;
        }
      }
      if (msg.includes('racine carr√©e') && msg.includes('de')) {
        const numbers = msg.match(/\d+/g);
        if (numbers && numbers.length >= 1) {
          const sqrt = Math.sqrt(parseInt(numbers[0]));
          return `La racine carr√©e de ${numbers[0]} est ${sqrt.toFixed(2)}`;
        }
      }
      if (msg.includes('th√©or√®me de pythagore') || msg.includes('pythagore')) {
        return "Le th√©or√®me de Pythagore stipule que dans un triangle rectangle : a¬≤ + b¬≤ = c¬≤ o√π c est l'hypot√©nuse et a et b sont les deux autres c√¥t√©s.";
      }
      if (msg.includes('nombre pi') || msg === 'pi') {
        return "Le nombre Pi (œÄ) est une constante math√©matique √©gale √† environ 3,14159265359. C'est le rapport entre la circonf√©rence d'un cercle et son diam√®tre.";
      }

      // ===== PHYSIQUE =====
      if (msg.includes('vitesse') && msg.includes('lumi√®re')) {
        return "La vitesse de la lumi√®re dans le vide est de 299 792 458 m/s (environ 300 000 km/s). C'est la vitesse maximale dans l'univers selon la th√©orie de la relativit√© d'Einstein.";
      }
      if (msg.includes('gravit√©') || msg.includes('gravitation')) {
        return "La gravit√© est une force d'attraction entre les masses. Sur Terre, l'acc√©l√©ration gravitationnelle est de 9,81 m/s¬≤. Isaac Newton a formul√© la loi de la gravitation universelle en 1687.";
      }
      if (msg.includes('th√©orie de la relativit√©') || (msg.includes('relativit√©') && msg.includes('einstein'))) {
        return "La th√©orie de la relativit√© d'Einstein (1905-1915) r√©volutionne la physique. La relativit√© restreinte lie espace et temps. La relativit√© g√©n√©rale d√©crit la gravit√© comme une courbure de l'espace-temps.";
      }
      if (msg.includes('atome') && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "Un atome est la plus petite unit√© d'un √©l√©ment chimique. Il est compos√© d'un noyau (protons et neutrons) entour√© d'√©lectrons. La taille d'un atome est d'environ 0,1 nanom√®tre.";
      }
      if (msg.includes('vitesse du son')) {
        return "La vitesse du son dans l'air √† 20¬∞C est d'environ 343 m/s (1 235 km/h). Elle varie selon le milieu : 1 480 m/s dans l'eau et 5 000 m/s dans l'acier.";
      }
      if (msg.includes('pourquoi') && msg.includes('ciel') && msg.includes('bleu')) {
        return "Le ciel est bleu √† cause de la diffusion Rayleigh. Les mol√©cules d'air diffusent davantage la lumi√®re bleue (ondes courtes) que les autres couleurs du spectre solaire.";
      }
      if (msg.includes('√©nergie') && (msg.includes('e=mc') || msg.includes('e = mc'))) {
        return "E=mc¬≤ est l'√©quation la plus c√©l√®bre d'Einstein. Elle signifie que l'√©nergie (E) est √©gale √† la masse (m) multipli√©e par la vitesse de la lumi√®re (c) au carr√©. Elle montre l'√©quivalence masse-√©nergie.";
      }

      // ===== CHIMIE =====
      if (msg.includes('tableau p√©riodique') || msg.includes('√©l√©ments chimiques')) {
        return "Le tableau p√©riodique classe les 118 √©l√©ments chimiques connus. Cr√©√© par Mendele√Øev en 1869, il organise les √©l√©ments par num√©ro atomique croissant et propri√©t√©s similaires.";
      }
      if (msg.includes('formule') && msg.includes('eau')) {
        return "La formule chimique de l'eau est H‚ÇÇO. Une mol√©cule d'eau contient 2 atomes d'hydrog√®ne (H) li√©s √† 1 atome d'oxyg√®ne (O).";
      }
      if (msg.includes('oxyg√®ne') && (msg.includes('c\'est quoi') || msg.includes('symbole'))) {
        return "L'oxyg√®ne (O) est l'√©l√©ment chimique de num√©ro atomique 8. C'est un gaz essentiel √† la vie, repr√©sentant 21% de l'atmosph√®re terrestre. Il a √©t√© d√©couvert en 1774.";
      }
      if (msg.includes('hydrog√®ne') && (msg.includes('c\'est quoi') || msg.includes('symbole'))) {
        return "L'hydrog√®ne (H) est l'√©l√©ment le plus simple et le plus abondant de l'univers (75% de la mati√®re). Son num√©ro atomique est 1. C'est un gaz tr√®s l√©ger.";
      }
      if (msg.includes('carbone') && (msg.includes('c\'est quoi') || msg.includes('symbole'))) {
        return "Le carbone (C) est l'√©l√©ment de base de la vie organique. De num√©ro atomique 6, il peut former 4 liaisons chimiques. Il existe sous forme de graphite, diamant et graph√®ne.";
      }
      if (msg.includes('or') && msg.includes('symbole')) {
        return "Le symbole chimique de l'or est Au (du latin Aurum). C'est un m√©tal pr√©cieux de num√©ro atomique 79, tr√®s rare et inalt√©rable.";
      }
      if (msg.includes('ph') && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "Le pH mesure l'acidit√© ou la basicit√© d'une solution sur une √©chelle de 0 √† 14. pH < 7 = acide, pH = 7 = neutre, pH > 7 = basique. L'eau pure a un pH de 7.";
      }

      // ===== ASTRONOMIE =====
      if ((msg.includes('distance') || msg.includes('loin')) && msg.includes('lune')) {
        return "La distance moyenne entre la Terre et la Lune est de 384 400 km. Elle varie de 356 500 km (p√©rig√©e) √† 406 700 km (apog√©e) en raison de l'orbite elliptique.";
      }
      if ((msg.includes('distance') || msg.includes('loin')) && msg.includes('soleil')) {
        return "La distance moyenne Terre-Soleil est de 149,6 millions de km (1 UA - Unit√© Astronomique). La lumi√®re du Soleil met 8 minutes et 20 secondes pour nous parvenir.";
      }
      if (msg.includes('combien') && msg.includes('plan√®te')) {
        return "Le syst√®me solaire compte 8 plan√®tes : Mercure, V√©nus, Terre, Mars (telluriques), Jupiter, Saturne, Uranus, Neptune (gazeuses). Pluton a √©t√© reclass√©e en plan√®te naine en 2006.";
      }
      if ((msg.includes('plus grosse') || msg.includes('plus grande')) && msg.includes('plan√®te')) {
        return "Jupiter est la plus grande plan√®te du syst√®me solaire. Son diam√®tre est de 142 984 km (11 fois celui de la Terre) et sa masse repr√©sente 2,5 fois celle de toutes les autres plan√®tes r√©unies.";
      }
      if (msg.includes('galaxie') && (msg.includes('c\'est quoi') || msg.includes('voie lact√©e'))) {
        return "Une galaxie est un ensemble d'√©toiles, de gaz et de poussi√®res li√©s par la gravit√©. Notre galaxie, la Voie Lact√©e, contient 200 √† 400 milliards d'√©toiles et mesure 100 000 ann√©es-lumi√®re de diam√®tre.";
      }
      if (msg.includes('big bang')) {
        return "Le Big Bang est la th√©orie cosmologique de la naissance de l'univers il y a 13,8 milliards d'ann√©es. L'univers √©tait initialement infiniment dense et chaud, puis s'est √©tendu et refroidi.";
      }

      // ===== BIOLOGIE =====
      if (msg.includes('adn') || msg.includes('acide d√©soxyribonucl√©ique')) {
        return "L'ADN (Acide D√©soxyriboNucl√©ique) est la mol√©cule qui contient l'information g√©n√©tique. Elle a une structure en double h√©lice d√©couverte par Watson et Crick en 1953.";
      }
      if (msg.includes('photosynth√®se')) {
        return "La photosynth√®se est le processus par lequel les plantes transforment le CO‚ÇÇ et l'eau en glucose et oxyg√®ne gr√¢ce √† l'√©nergie lumineuse. √âquation : 6CO‚ÇÇ + 6H‚ÇÇO + lumi√®re ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ";
      }
      if (msg.includes('cellule') && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "La cellule est l'unit√© de base de tout √™tre vivant. Le corps humain contient environ 37 000 milliards de cellules. Il existe deux types : procaryotes (sans noyau) et eucaryotes (avec noyau).";
      }

      // ===== TECHNOLOGIE =====
      if (msg.includes('python') && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "Python est un langage de programmation cr√©√© en 1991 par Guido van Rossum. Populaire pour sa syntaxe claire, il est utilis√© en IA, data science, web, automatisation. Version actuelle : Python 3.12.";
      }
      if (msg.includes('javascript') && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "JavaScript est un langage de programmation cr√©√© en 1995 par Brendan Eich. Il rend les pages web interactives et est essentiel au d√©veloppement web moderne (front-end et back-end avec Node.js).";
      }
      if ((msg.includes('intelligence artificielle') || msg.includes('ia')) && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "L'Intelligence Artificielle (IA) vise √† cr√©er des machines capables d'imiter l'intelligence humaine : apprentissage, raisonnement, reconnaissance. Les domaines incluent le machine learning, les r√©seaux de neurones et le deep learning.";
      }
      if (msg.includes('internet') && (msg.includes('c\'est quoi') || msg.includes('qu\'est-ce'))) {
        return "Internet est un r√©seau mondial d'ordinateurs interconnect√©s. Cr√©√© dans les ann√©es 1960-70 (ARPANET), rendu public en 1991 avec le World Wide Web de Tim Berners-Lee. Plus de 5 milliards d'utilisateurs en 2024.";
      }
      if (msg.includes('blockchain')) {
        return "La blockchain est une technologie de stockage et de transmission d'informations de mani√®re d√©centralis√©e et s√©curis√©e. C'est la base des cryptomonnaies comme le Bitcoin (cr√©√© en 2009).";
      }

      // ===== HISTOIRE =====
      if (msg.includes('premi√®re guerre mondiale') || msg.includes('1ere guerre')) {
        return "La Premi√®re Guerre mondiale (1914-1918) a oppos√© les Alli√©s (France, Royaume-Uni, Russie, USA) aux Empires centraux (Allemagne, Autriche-Hongrie). Bilan : 18 millions de morts.";
      }
      if (msg.includes('seconde guerre mondiale') || msg.includes('2eme guerre') || msg.includes('2nde guerre')) {
        return "La Seconde Guerre mondiale (1939-1945) a oppos√© les Alli√©s (USA, URSS, Royaume-Uni, France) √† l'Axe (Allemagne nazie, Italie, Japon). Bilan : 70 millions de morts.";
      }
      if (msg.includes('r√©volution fran√ßaise')) {
        return "La R√©volution fran√ßaise (1789-1799) a aboli la monarchie absolue et proclam√© la R√©publique. √âv√©nements cl√©s : prise de la Bastille (14 juillet 1789), D√©claration des droits de l'homme (26 ao√ªt 1789).";
      }

      // ===== ACTUALIT√â G√âN√âRALE =====
      if (msg.includes('m√©t√©o') || msg.includes('temps qu\'il fait')) {
        return "Je n'ai pas acc√®s aux donn√©es m√©t√©o en temps r√©el car je ne suis pas connect√© √† Internet. Pour conna√Ætre la m√©t√©o actuelle, consultez M√©t√©o France, Weather.com ou votre application m√©t√©o.";
      }
      if (msg.includes('quelle heure') || msg.includes('l\'heure')) {
        const now = new Date();
        const heures = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const secondes = now.getSeconds().toString().padStart(2, '0');
        return `Il est actuellement ${heures}:${minutes}:${secondes}.`;
      }
      if (msg.includes('quelle date') || msg.includes('quel jour') || msg.includes('aujourd\'hui')) {
        const now = new Date();
        const jours = ['dimanche', 'lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi'];
        const mois = ['janvier', 'f√©vrier', 'mars', 'avril', 'mai', 'juin', 'juillet', 'ao√ªt', 'septembre', 'octobre', 'novembre', 'd√©cembre'];
        return `Nous sommes le ${jours[now.getDay()]} ${now.getDate()} ${mois[now.getMonth()]} ${now.getFullYear()}.`;
      }

      // R√©ponse par d√©faut
      return "Je comprends votre question, mais je n'ai pas de r√©ponse pr√©cise dans ma base de connaissances. Je peux vous renseigner sur : capitales mondiales, g√©ographie, math√©matiques, physique, chimie, astronomie, biologie, technologie, histoire. Reformulez votre question !";
    }

    function createMessageElement(text, sender) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}`;
      
      const avatar = document.createElement('div');
      avatar.className = 'message-avatar';
      avatar.textContent = sender === 'bot' ? 'ü§ñ' : 'üë§';
      
      const bubble = document.createElement('div');
      bubble.className = 'message-bubble';
      bubble.textContent = text;
      
      messageDiv.appendChild(avatar);
      messageDiv.appendChild(bubble);
      
      return messageDiv;
    }

    function showTypingIndicator() {
      typingIndicator.classList.add('active');
      chatMessages.appendChild(typingIndicator);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function hideTypingIndicator() {
      typingIndicator.classList.remove('active');
      if (typingIndicator.parentNode) {
        typingIndicator.parentNode.removeChild(typingIndicator);
      }
    }

    async function addMessage(text, sender) {
      if (emptyState.style.display !== 'none') {
        emptyState.style.display = 'none';
      }

      const messageId = Date.now().toString() + Math.random().toString(36).substr(2, 9);
      
      const result = await window.dataSdk.create({
        id: messageId,
        message: text,
        sender: sender,
        timestamp: Date.now()
      });

      if (!result.isOk) {
        console.error('Erreur lors de l\'enregistrement du message');
      }
    }

    async function handleSubmit(e) {
      e.preventDefault();
      
      const text = userInput.value.trim();
      if (!text || isTyping) return;

      sendButton.disabled = true;
      userInput.disabled = true;

      await addMessage(text, 'user');
      userInput.value = '';

      isTyping = true;
      showTypingIndicator();

      setTimeout(async () => {
        const response = getBotResponse(text);
        hideTypingIndicator();
        await addMessage(response, 'bot');
        isTyping = false;
        sendButton.disabled = false;
        userInput.disabled = false;
        userInput.focus();
      }, 1000 + Math.random() * 1000);
    }

    chatForm.addEventListener('submit', handleSubmit);

    const dataHandler = {
      onDataChanged(data) {
        messages = data.sort((a, b) => a.timestamp - b.timestamp);
        
        const existingMessages = new Map(
          [...chatMessages.querySelectorAll('.message')].map(el => [el.dataset.messageId, el])
        );

        messages.forEach(msg => {
          if (!existingMessages.has(msg.id)) {
            const messageEl = createMessageElement(msg.message, msg.sender);
            messageEl.dataset.messageId = msg.id;
            chatMessages.appendChild(messageEl);
          }
          existingMessages.delete(msg.id);
        });

        existingMessages.forEach(el => el.remove());

        if (messages.length > 0 && emptyState.style.display !== 'none') {
          emptyState.style.display = 'none';
        }

        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
    };

    async function onConfigChange(config) {
      const botNameEl = document.getElementById('bot-name');
      const welcomeMessageEl = document.getElementById('welcome-message');
      const chatWrapper = document.querySelector('.chat-wrapper');
      const fontFamily = config.font_family || defaultConfig.font_family;
      const fontSize = config.font_size || defaultConfig.font_size;

      botNameEl.textContent = config.bot_name || defaultConfig.bot_name;
      welcomeMessageEl.textContent = config.welcome_message || defaultConfig.welcome_message;

      chatWrapper.style.background = `linear-gradient(135deg, ${config.background_start || defaultConfig.background_start} 0%, ${config.background_middle || defaultConfig.background_middle} 50%, ${config.background_end || defaultConfig.background_end} 100%)`;

      document.body.style.fontFamily = `${fontFamily}, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`;
      
      botNameEl.style.fontSize = `${fontSize * 1.75}px`;
      welcomeMessageEl.style.fontSize = `${fontSize}px`;
      
      document.querySelectorAll('.message-bubble').forEach(bubble => {
        bubble.style.fontSize = `${fontSize}px`;
      });

      userInput.style.fontSize = `${fontSize}px`;
      sendButton.style.fontSize = `${fontSize}px`;

      const style = document.createElement('style');
      style.textContent = `
        .message.bot .message-bubble {
          background: linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color} 0%, ${config.primary_color || defaultConfig.primary_color}dd 100%) !important;
        }
        .message.user .message-bubble {
          background: ${config.user_message_color || defaultConfig.user_message_color} !important;
        }
        .send-button {
          background: linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color} 0%, ${config.primary_color || defaultConfig.primary_color}dd 100%) !important;
        }
      `;
      document.head.appendChild(style);
    }

    async function init() {
      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error('Erreur lors de l\'initialisation du SDK de donn√©es');
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_start || defaultConfig.background_start,
                set: (value) => {
                  config.background_start = value;
                  window.elementSdk.setConfig({ background_start: value });
                }
              },
              {
                get: () => config.background_middle || defaultConfig.background_middle,
                set: (value) => {
                  config.background_middle = value;
                  window.elementSdk.setConfig({ background_middle: value });
                }
              },
              {
                get: () => config.background_end || defaultConfig.background_end,
                set: (value) => {
                  config.background_end = value;
                  window.elementSdk.setConfig({ background_end: value });
                }
              },
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  config.primary_color = value;
                  window.elementSdk.setConfig({ primary_color: value });
                }
              },
              {
                get: () => config.user_message_color || defaultConfig.user_message_color,
                set: (value) => {
                  config.user_message_color = value;
                  window.elementSdk.setConfig({ user_message_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["bot_name", config.bot_name || defaultConfig.bot_name],
            ["welcome_message", config.welcome_message || defaultConfig.welcome_message]
          ])
        });
      }
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aa0e83a21474b0a',t:'MTc2NTA3NzgzNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
